<div class="buildings-container">
  <div class="header">
    <h3>Company Buildings</h3>
    <button (click)="initAdd()" *ngIf="!showForm" class="btn btn-primary">Add Building</button>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div *ngIf="isLoading" class="loading">
    Loading...
  </div>

  <!-- Form Section -->
  <div *ngIf="showForm" class="building-form card p-3 mb-3">
    <h4>{{ isEditing ? 'Edit' : 'Add' }} Building</h4>
    
    <div class="form-group mb-2">
      <label>Address *</label>
      <input [(ngModel)]="currentBuilding.address" class="form-control" placeholder="Address">
    </div>
    
    <div class="row mb-2">
      <div class="col-md-6">
        <label>Postal Code</label>
        <input [(ngModel)]="currentBuilding.postal_code" class="form-control" placeholder="Postal Code">
      </div>
      <div class="col-md-6">
        <label>City</label>
        <input [(ngModel)]="currentBuilding.city" class="form-control" placeholder="City">
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-md-6">
        <label>Country</label>
        <input [(ngModel)]="currentBuilding.country" class="form-control" placeholder="Country">
      </div>
      <div class="col-md-6">
        <label>Type</label>
        <select [(ngModel)]="currentBuilding.building_type" class="form-control">
          <option value="">Select Type</option>
          <option value="Bureau">Bureau</option>
          <option value="Entrepôt">Entrepôt</option>
          <option value="Résidentiel">Résidentiel</option>
          <option value="Usine">Usine</option>
        </select>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col-md-6">
        <label>Surface Area (m²)</label>
        <input type="number" [(ngModel)]="currentBuilding.surface_area" class="form-control" placeholder="Surface Area">
      </div>
      <div class="col-md-6">
        <label>Construction Year</label>
        <input type="number" [(ngModel)]="currentBuilding.construction_year" class="form-control" placeholder="Year">
      </div>
    </div>

    <div class="form-actions mt-3">
      <button (click)="saveBuilding()" [disabled]="isLoading" class="btn btn-success me-2">Save</button>
      <button (click)="cancelForm()" class="btn btn-secondary">Cancel</button>
    </div>
  </div>

  <!-- List Section -->
  <div *ngIf="!showForm && !isLoading" class="buildings-list">
    <div *ngIf="buildings.length === 0" class="alert alert-info">
      No buildings found for this company.
    </div>

    <div *ngFor="let building of buildings" class="card mb-2 p-3">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h5 class="mb-1">{{ building.address }}</h5>
          <p class="mb-1 text-muted">{{ building.postal_code }} {{ building.city }}, {{ building.country }}</p>
          <small>{{ building.building_type }} <span *ngIf="building.surface_area">- {{ building.surface_area }} m²</span></small>
        </div>
        <div>
          <button (click)="initEdit(building)" class="btn btn-sm btn-outline-primary me-2">Edit</button>
          <button (click)="deleteBuilding(building.id)" class="btn btn-sm btn-outline-danger">Delete</button>
        </div>
      </div>
    </div>
  </div>
</div>
